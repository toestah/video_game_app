<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Game App</title>
    <link rel="stylesheet" href="/css/styles.css">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body x-data="gameApp()" @keydown.window="handleKeyPress($event)">

    <!-- Background -->
    <div class="game-background"></div>

    <!-- Main Container -->
    <div class="game-container">

        <!-- Startup Screen -->
        <div x-show="screen === 'startup'"
             x-transition:enter="fade-in"
             x-transition:leave="fade-out"
             class="screen startup-screen">
            <div class="startup-logo">
                <h1 class="game-title">Business Operating System</h1>
                <p class="press-start" x-show="showPressStart">Press any key to start</p>
            </div>
        </div>

        <!-- Save File Selection Screen -->
        <div x-show="screen === 'save-select'"
             x-transition:enter="slide-in"
             x-transition:leave="slide-out"
             class="screen save-select-screen">
            <h2 class="screen-title">Select User Account</h2>
            <div class="save-slots">
                <template x-for="(save, index) in saves" :key="index">
                    <div class="save-slot"
                         :class="{ 'selected': selectedSlot === index, 'empty': !save.name }"
                         @click="selectSaveSlot(index)">
                        <div class="slot-number">Slot <span x-text="index + 1"></span></div>
                        <template x-if="save.name">
                            <div class="save-info">
                                <div class="save-name" x-text="save.name"></div>
                                <div class="save-meta">
                                    <span x-text="save.playtime"></span> ·
                                    <span x-text="save.date"></span>
                                </div>
                            </div>
                        </template>
                        <template x-if="!save.name">
                            <div class="empty-slot">Empty</div>
                        </template>
                    </div>
                </template>
            </div>
            <div class="menu-buttons">
                <button class="game-button" @click="confirmSaveSelection()">Continue</button>
                <button class="game-button secondary" @click="screen = 'startup'">Back</button>
            </div>
        </div>

        <!-- Settings Screen -->
        <div x-show="screen === 'settings'"
             x-transition:enter="slide-in"
             x-transition:leave="slide-out"
             class="screen settings-screen">

            <div class="settings-container">
                <!-- Left Panel: Categories -->
                <div class="settings-left-panel">
                    <h2 class="settings-title">SETTINGS</h2>
                    <div class="settings-categories">
                        <button class="settings-category"
                                :class="{ 'selected': selectedSettingCategory === 0 }"
                                @click="selectedSettingCategory = 0"
                                @mouseenter="selectedSettingCategory = 0">
                            <span>Display</span>
                        </button>
                        <button class="settings-category"
                                :class="{ 'selected': selectedSettingCategory === 1 }"
                                @click="selectedSettingCategory = 1"
                                @mouseenter="selectedSettingCategory = 1">
                            <span>Audio</span>
                        </button>
                        <button class="settings-category"
                                :class="{ 'selected': selectedSettingCategory === 2 }"
                                @click="selectedSettingCategory = 2"
                                @mouseenter="selectedSettingCategory = 2">
                            <span>Controls</span>
                        </button>
                        <button class="settings-category"
                                :class="{ 'selected': selectedSettingCategory === 3 }"
                                @click="selectedSettingCategory = 3"
                                @mouseenter="selectedSettingCategory = 3">
                            <span>About</span>
                        </button>
                    </div>
                </div>

                <!-- Right Panel: Settings Options -->
                <div class="settings-right-panel">
                    <!-- Display Settings -->
                    <div x-show="selectedSettingCategory === 0" class="settings-group">
                        <h3 class="settings-group-title">Display</h3>
                        <div class="setting-item">
                            <span class="setting-label">Fullscreen</span>
                            <button class="game-button" @click="toggleFullscreen()">Toggle</button>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Screen Resolution</span>
                            <span class="setting-value">Auto</span>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Graphics Quality</span>
                            <span class="setting-value">High</span>
                        </div>
                    </div>

                    <!-- Audio Settings -->
                    <div x-show="selectedSettingCategory === 1" class="settings-group">
                        <h3 class="settings-group-title">Audio</h3>
                        <div class="setting-item">
                            <span class="setting-label">Master Volume</span>
                            <span class="setting-value">100%</span>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Music Volume</span>
                            <span class="setting-value">80%</span>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Sound Effects</span>
                            <span class="setting-value">100%</span>
                        </div>
                    </div>

                    <!-- Controls Settings -->
                    <div x-show="selectedSettingCategory === 2" class="settings-group">
                        <h3 class="settings-group-title">Controls</h3>
                        <div class="setting-item">
                            <span class="setting-label">Navigation</span>
                            <span class="setting-value">Arrow Keys</span>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Select</span>
                            <span class="setting-value">Enter</span>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Back</span>
                            <span class="setting-value">Escape</span>
                        </div>
                    </div>

                    <!-- About -->
                    <div x-show="selectedSettingCategory === 3" class="settings-group">
                        <h3 class="settings-group-title">About</h3>
                        <div class="about-info">
                            <p><strong>Business Operating System</strong></p>
                            <p>Version 1.0.0</p>
                            <p class="about-description">A 2000s Sony-inspired game UI with modern polish. Built with Express.js, Alpine.js, and pure CSS.</p>
                            <p class="about-links">
                                <a href="https://github.com/toestah/video_game_app" target="_blank" class="about-link">GitHub Repository</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="menu-buttons">
                <button class="game-button secondary" @click="screen = 'main-menu'">Back to Menu</button>
            </div>
        </div>

        <!-- Main Menu Screen -->
        <div x-show="screen === 'main-menu'"
             x-transition:enter="slide-in"
             x-transition:leave="slide-out"
             class="screen main-menu-screen">

            <!-- Background Image -->
            <div class="menu-background"
                 :style="`background-image: url('${getCurrentMenuImage()}')`"></div>

            <!-- Menu Content Container -->
            <div class="menu-container">

                <!-- Left Panel: Menu Options -->
                <div class="menu-left-panel">
                    <h2 class="menu-title">SELECT MODE</h2>
                    <div class="menu-options">
                        <template x-for="(option, index) in menuItems" :key="index">
                            <button class="menu-option"
                                    :class="{ 'selected': selectedMenuIndex === index }"
                                    @click="selectMenu(index)"
                                    @mouseenter="selectedMenuIndex = index">
                                <span class="menu-label" x-text="option.name"></span>
                            </button>
                        </template>
                    </div>
                </div>

                <!-- Right Panel: Details -->
                <div class="menu-right-panel">
                    <div class="detail-card">
                        <h3 class="detail-title" x-text="menuItems[selectedMenuIndex].name"></h3>
                        <p class="detail-description" x-text="menuItems[selectedMenuIndex].description"></p>
                        <div class="detail-meta">
                            <span class="meta-item" x-text="menuItems[selectedMenuIndex].meta"></span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Dialog Modal -->
        <div x-show="dialog.show"
             x-transition:enter="fade-in-fast"
             x-transition:leave="fade-out-fast"
             class="dialog-overlay">
            <div class="dialog-modal"
                 x-transition:enter="scale-in"
                 x-transition:leave="scale-out">
                <div class="dialog-content">
                    <p class="dialog-text" x-text="dialog.message"></p>
                </div>
                <div class="dialog-buttons">
                    <template x-for="(button, index) in dialog.buttons" :key="index">
                        <button class="game-button"
                                :class="button.type || 'primary'"
                                @click="handleDialogButton(button)">
                            <span x-text="button.label"></span>
                        </button>
                    </template>
                </div>
            </div>
        </div>

        <!-- Name Input Modal -->
        <div x-show="showNameInput"
             x-transition:enter="fade-in-fast"
             x-transition:leave="fade-out-fast"
             class="dialog-overlay">
            <div class="dialog-modal"
                 x-transition:enter="scale-in"
                 x-transition:leave="scale-out">
                <div class="dialog-content">
                    <p class="dialog-text">Enter a name for your save file:</p>
                    <input type="text"
                           x-model="newSaveName"
                           @keydown.enter="createNewSave()"
                           class="name-input"
                           placeholder="Player Name"
                           maxlength="20"
                           autofocus>
                </div>
                <div class="dialog-buttons">
                    <button class="game-button" @click="createNewSave()">Create</button>
                    <button class="game-button secondary" @click="showNameInput = false">Cancel</button>
                </div>
            </div>
        </div>

    </div>

    <!-- Global Button Prompts -->
    <div class="button-prompts-container" x-show="!dialog.show && !showNameInput">
        <!-- Startup Screen Prompts -->
        <template x-if="screen === 'startup' && showPressStart">
            <div class="button-prompt">
                <span class="key-hint">Any Key</span>
                <span>Start</span>
            </div>
        </template>

        <!-- Save Select Prompts -->
        <template x-if="screen === 'save-select'">
            <div style="display: flex; flex-direction: column; gap: 0.5rem; align-items: flex-end;">
                <div class="button-prompt">
                    <span class="key-hint">↑↓</span>
                    <span>Navigate</span>
                </div>
                <div class="button-prompt">
                    <span class="key-hint">Enter</span>
                    <span>Select</span>
                </div>
                <div class="button-prompt">
                    <span class="key-hint">Esc</span>
                    <span>Back</span>
                </div>
            </div>
        </template>

        <!-- Main Menu Prompts -->
        <template x-if="screen === 'main-menu'">
            <div style="display: flex; flex-direction: column; gap: 0.5rem; align-items: flex-end;">
                <div class="button-prompt">
                    <span class="key-hint">↑↓</span>
                    <span>Navigate</span>
                </div>
                <div class="button-prompt">
                    <span class="key-hint">Enter</span>
                    <span>Select</span>
                </div>
                <div class="button-prompt">
                    <span class="key-hint">F11</span>
                    <span>Fullscreen</span>
                </div>
            </div>
        </template>
    </div>

    <script src="/js/storage.js"></script>
    <script src="/js/app.js"></script>
</body>
</html>
